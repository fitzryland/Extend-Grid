$darkPurple: #655795;
$purple: #9f90ff;
$lightPurple: #d3cbff;

@mixin group() {
	&:after {
		content: "";
		display: table;
		clear: both;
	}
}

//
// This is the bread and butter
//

// (name, breakpoint-min-width, breakpoint-max-width, max-width, gutter, columns)
$layouts:
	(small, 0px, 600px, 100%, 4%, 2)
	(medium, 601px, 959px, 100%, 3%, 4)
	(medium-andup, 601px, 99999px, 100%, 3%, 4) // really not ideal way to add a media query
	(large, 960px, 99999px, 1200px, 2%, 6);

// add a media query for each layout
@mixin break($media) {
	@each $layout in $layouts {
		@if nth($layout, 1) == $media {
			@media all and
				(min-width: nth($layout, 2)) and
				(max-width: nth($layout, 3))
				{ @content; }
		}
	}
}

// Extendable Flexible Grid
@each $layout in $layouts {
	$layout-name: nth($layout, 1);
	$min-width: nth($layout, 2);
	$max-width: nth($layout, 3);
	$width: nth($layout, 4);
	$gutter: nth($layout, 5);
	$columns: nth($layout, 6);
	@media all and (max-width: $max-width) and (min-width: $min-width) {
		@for $ii from 1 through $columns {
			%#{$layout-name}-cols-#{$ii} {
				width: ($ii * ((100% + $gutter) / $columns)) - $gutter;
				margin-right: $gutter;
			}
		}
		%#{$layout-name}-wrap {
			max-width: $width;
		}
		%#{$layout-name}-rowstart {
			clear: both;
		}
		%#{$layout-name}-rowend {
			margin-right: 0;
		}
	}
}

* {
	box-sizing: border-box;
}
html {
	background-color: $darkPurple;
}

section {
	@extend %small-wrap;
	@extend %medium-wrap;
	@extend %large-wrap;
	background-color: $purple;
	margin: 0 auto;
	@include group();
}
.block1, .block2, .block3, .block4, .block5, .block6, .block7 {
	border: 1px solid $darkPurple;
	background-color: $lightPurple;
	float: left;
	min-height: 100px;
	margin-top: 1em;
	padding: 1em;
}
.block1 {
	@extend %small-cols-1;
	@extend %medium-cols-1;
	@extend %large-cols-2;
	h1 {
		margin: 0;
	}
	@include break(small) {
		background-color: red;
	}
	@include break(medium) {
		background-color: orange;
	}
	@include break(medium-andup) {
		height: 20em;
	}
	@include break(large) {
		background-color: yellow;
	}
}
.block2 {
	@extend %small-cols-1, %small-rowend;
	@extend %medium-cols-1;
	@extend %large-cols-2;
}
.block3 {
	@extend %small-cols-2, %small-rowend;
	@extend %medium-cols-2, %medium-rowend;
	@extend %large-cols-1;
	@include break(medium) {
		height: 20em;
	}
}
.block4 {
	@extend %small-cols-1;
	@extend %medium-cols-3, %medium-rowstart;
	@extend %large-cols-1, %large-rowend;
}
.block5 {
	@extend %small-cols-1, %small-rowend;
	@extend %medium-cols-1, %medium-rowend;
	@extend %large-cols-3;
}
.block6 {
	@extend %small-cols-2;
	@extend %medium-cols-2, %medium-rowstart;
	@extend %large-cols-1;
}
.block7 {
	@extend %small-cols-1;
	@extend %medium-cols-2, %medium-rowend;
	@extend %large-cols-2, %large-rowend;
}